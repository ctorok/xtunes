<div class="songs">
  <!-- There will be two types of listings. One for the admin and guest, with ALL songs, and one for the logged in user, who will see all songs MINUS the ones they purchased -->

<% if !current_user || current_user.user_type == "A"%>
  <h1>Listing all songs</h1>
  <% else %>
  <h1>Songs I can purchase</h1>
<% end %>


  <table>
    <tr>
      <th>Name</th> 
      <th>Artist</th> 
      <th>Album</th> 
      <th>Price</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </table>
</div>
    <div class="songs">
      <table>
        <% @songs.each do |song| %>
          <tr>
            <td><%= song.name %></td>
            <td>
              <% song.artists.each do |a|%>
              <%= a.name %>
              <% end %>
            </td>
            <td>
              <% song.albums.each do |a|%>
              <%= a.name %>
              <% end %>
            </td>
            <td><%= song.price %></td>
            
              <td style="border: 1px black dotted;"><%= audio_tag song.audiofile, :controls => true %>
              </td>
            




            <td><%= link_to 'Show', song %></td>
            <% if can? :update, @song %>
              <td><%= link_to 'Edit', edit_song_path(song) %></td>
              <td><%= link_to 'Destroy', song, method: :delete, data: { confirm: 'Are you sure?' } %></td>
            <% end %>
            <td><%= button_to 'Purchase', purchases_path(song_id: song) %></td>
          </tr>
        <% end %>
  </table>
  <br />
</div>

<%= link_to 'New song', new_song_path %>